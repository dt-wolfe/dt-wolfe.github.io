<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" href="favicon.ico" type="image/x-icon" />
    <title>Practice</title>
    <link rel="stylesheet" href="css/abcjs-audio.css">
    <script src="js/abcjs-basic-min.js" defer></script>
    <style>
        main {
            max-width: 770px;
            margin: 0 auto;
        }
    </style>
    <script type="text/javascript">

        const abc = [
            `X:1
T:The Maid Behind the Bar
L:1/4
M:2/2
Q:1/2=120
K:D
(D/E/) |: F/A/A/{/d}(B/ A/F/)E/D/ | F/A/A/{/d}(B/ A) d/e/ | f/(B/{/d}B/A/) B/c/d/(e/ |  f) g/f/ e/(d/B/A/) |
F/A/A/{/d}(B/ A/F/)E/D/ | F/A/A/{/d}(B/ A) d/e/ | f/(B/{/d}B/A/) B/c/d/(B/ |1  A/F/)E/F/ D (D/E/) :|2 A/F/)E/F/ D3/2 (e/ ||
|: f/g/)a/g/ f/d/d/e/ | f/d/a/d/ f/d/d/(f/ |  e/f/)g/a/ b/e/e/(f/ | (3g/f/e/) b/e/ g/e/e/(a/ |
f/g/)a/(f/ b) a/f/ | d/e/f/(d/ e) d/e/ |  f/(B/{/d}B/A/) B/c/d/(B/ |1 A/F/)E/F/ D3/2 (e/ :|2 A/F/)E/F/ D3/2 |]
`, `X:1
T:1 Bars - The Maid Behind the Bar
L:1/8
Q:1/2=120
M:2/2
I:linebreak $
K:D
V:1 treble 
V:1
(DE) | FAA{/d}(B AF)ED |
`, `X:2
T:1 Bars - The Maid Behind the Bar
L:1/8
Q:1/2=120
M:2/2
I:linebreak $
K:D
V:1 treble 
V:1
FAA{/d}(B A2) de |
`, `X:3
T:1 Bars - The Maid Behind the Bar
L:1/8
Q:1/2=120
M:2/2
I:linebreak $
K:D
V:1 treble 
V:1
f(B{/d}BA) Bcd(e |
`, `X:4
T:1 Bars - The Maid Behind the Bar
L:1/8
Q:1/2=120
M:2/2
I:linebreak $
K:D
V:1 treble 
V:1
f2) gf e(dBA) |
`, `X:5
T:1 Bars - The Maid Behind the Bar
L:1/8
Q:1/2=120
M:2/2
I:linebreak $
K:D
V:1 treble 
V:1
FAA{/d}(B AF)ED |
`, `X:6
T:1 Bars - The Maid Behind the Bar
L:1/8
Q:1/2=120
M:2/2
I:linebreak $
K:D
V:1 treble 
V:1
FAA{/d}(B A2) de |
`, `X:7
T:1 Bars - The Maid Behind the Bar
L:1/8
Q:1/2=120
M:2/2
I:linebreak $
K:D
V:1 treble 
V:1
f(B{/d}BA) Bcd(B |
`, `X:8
T:1 Bars - The Maid Behind the Bar
L:1/8
Q:1/2=120
M:2/2
I:linebreak $
K:D
V:1 treble 
V:1
AF)EF D2 (DE) |
`, `X:9
T:1 Bars - The Maid Behind the Bar
L:1/8
Q:1/2=120
M:2/2
I:linebreak $
K:D
V:1 treble 
V:1
FAA{/d}(B AF)ED |
`, `X:10
T:1 Bars - The Maid Behind the Bar
L:1/8
Q:1/2=120
M:2/2
I:linebreak $
K:D
V:1 treble 
V:1
FAA{/d}(B A2) de |
`, `X:11
T:1 Bars - The Maid Behind the Bar
L:1/8
Q:1/2=120
M:2/2
I:linebreak $
K:D
V:1 treble 
V:1
f(B{/d}BA) Bcd(e |
`, `X:12
T:1 Bars - The Maid Behind the Bar
L:1/8
Q:1/2=120
M:2/2
I:linebreak $
K:D
V:1 treble 
V:1
$ f2) gf e(dBA) |
`, `X:13
T:1 Bars - The Maid Behind the Bar
L:1/8
Q:1/2=120
M:2/2
I:linebreak $
K:D
V:1 treble 
V:1
FAA{/d}(B AF)ED |
`, `X:14
T:1 Bars - The Maid Behind the Bar
L:1/8
Q:1/2=120
M:2/2
I:linebreak $
K:D
V:1 treble 
V:1
FAA{/d}(B A2) de |
`, `X:15
T:1 Bars - The Maid Behind the Bar
L:1/8
Q:1/2=120
M:2/2
I:linebreak $
K:D
V:1 treble 
V:1
f(B{/d}BA) BcdB |
`, `X:16
T:1 Bars - The Maid Behind the Bar
L:1/8
Q:1/2=120
M:2/2
I:linebreak $
K:D
V:1 treble 
V:1
AFEF D3 e ||
`, `X:17
T:1 Bars - The Maid Behind the Bar
L:1/8
Q:1/2=120
M:2/2
I:linebreak $
K:D
V:1 treble 
V:1
fgag fdde |
`, `X:18
T:1 Bars - The Maid Behind the Bar
L:1/8
Q:1/2=120
M:2/2
I:linebreak $
K:D
V:1 treble 
V:1
$ fdad fdd(f |
`, `X:19
T:1 Bars - The Maid Behind the Bar
L:1/8
Q:1/2=120
M:2/2
I:linebreak $
K:D
V:1 treble 
V:1
ef)ga bee(f |
`, `X:20
T:1 Bars - The Maid Behind the Bar
L:1/8
Q:1/2=120
M:2/2
I:linebreak $
K:D
V:1 treble 
V:1
(3gfe) be gee(a |
`, `X:21
T:1 Bars - The Maid Behind the Bar
L:1/8
Q:1/2=120
M:2/2
I:linebreak $
K:D
V:1 treble 
V:1
fg)a(f b2) af |
`, `X:22
T:1 Bars - The Maid Behind the Bar
L:1/8
Q:1/2=120
M:2/2
I:linebreak $
K:D
V:1 treble 
V:1
def(d e2) de |
`, `X:23
T:1 Bars - The Maid Behind the Bar
L:1/8
Q:1/2=120
M:2/2
I:linebreak $
K:D
V:1 treble 
V:1
f(B{/d}BA) Bcd(B |
`, `X:24
T:1 Bars - The Maid Behind the Bar
L:1/8
Q:1/2=120
M:2/2
I:linebreak $
K:D
V:1 treble 
V:1
$ AF)EF D3 e |
`, `X:25
T:1 Bars - The Maid Behind the Bar
L:1/8
Q:1/2=120
M:2/2
I:linebreak $
K:D
V:1 treble 
V:1
fgag fdde |
`, `X:26
T:1 Bars - The Maid Behind the Bar
L:1/8
Q:1/2=120
M:2/2
I:linebreak $
K:D
V:1 treble 
V:1
fdad fdd(f |
`, `X:27
T:1 Bars - The Maid Behind the Bar
L:1/8
Q:1/2=120
M:2/2
I:linebreak $
K:D
V:1 treble 
V:1
ef)ga bee(f |
`, `X:28
T:1 Bars - The Maid Behind the Bar
L:1/8
Q:1/2=120
M:2/2
I:linebreak $
K:D
V:1 treble 
V:1
(3gfe) be gee(a |
`, `X:29
T:1 Bars - The Maid Behind the Bar
L:1/8
Q:1/2=120
M:2/2
I:linebreak $
K:D
V:1 treble 
V:1
fg)a(f b2) af |
`, `X:30
T:1 Bars - The Maid Behind the Bar
L:1/8
Q:1/2=120
M:2/2
I:linebreak $
K:D
V:1 treble 
V:1
$ def(d e2) de |
`, `X:31
T:1 Bars - The Maid Behind the Bar
L:1/8
Q:1/2=120
M:2/2
I:linebreak $
K:D
V:1 treble 
V:1
f(B{/d}BA) BcdB |
`, `X:32
T:1 Bars - The Maid Behind the Bar
L:1/8
Q:1/2=120
M:2/2
I:linebreak $
K:D
V:1 treble 
V:1
AFEF D3 |]
`, `X:1
T:2 Bars - The Maid Behind the Bar
L:1/8
Q:1/2=120
M:2/2
I:linebreak $
K:D
V:1 treble 
V:1
(DE) | FAA{/d}(B AF)ED | FAA{/d}(B A2) de |
`, `X:2
T:2 Bars - The Maid Behind the Bar
L:1/8
Q:1/2=120
M:2/2
I:linebreak $
K:D
V:1 treble 
V:1
f(B{/d}BA) Bcd(e | f2) gf e(dBA) |
`, `X:3
T:2 Bars - The Maid Behind the Bar
L:1/8
Q:1/2=120
M:2/2
I:linebreak $
K:D
V:1 treble 
V:1
FAA{/d}(B AF)ED | FAA{/d}(B A2) de |
`, `X:4
T:2 Bars - The Maid Behind the Bar
L:1/8
Q:1/2=120
M:2/2
I:linebreak $
K:D
V:1 treble 
V:1
f(B{/d}BA) Bcd(B | AF)EF D2 (DE) |
`, `X:5
T:2 Bars - The Maid Behind the Bar
L:1/8
Q:1/2=120
M:2/2
I:linebreak $
K:D
V:1 treble 
V:1
FAA{/d}(B AF)ED | FAA{/d}(B A2) de |
`, `X:6
T:2 Bars - The Maid Behind the Bar
L:1/8
Q:1/2=120
M:2/2
I:linebreak $
K:D
V:1 treble 
V:1
f(B{/d}BA) Bcd(e | $ f2) gf e(dBA) |
`, `X:7
T:2 Bars - The Maid Behind the Bar
L:1/8
Q:1/2=120
M:2/2
I:linebreak $
K:D
V:1 treble 
V:1
FAA{/d}(B AF)ED | FAA{/d}(B A2) de |
`, `X:8
T:2 Bars - The Maid Behind the Bar
L:1/8
Q:1/2=120
M:2/2
I:linebreak $
K:D
V:1 treble 
V:1
f(B{/d}BA) BcdB | AFEF D3 e ||
`, `X:9
T:2 Bars - The Maid Behind the Bar
L:1/8
Q:1/2=120
M:2/2
I:linebreak $
K:D
V:1 treble 
V:1
fgag fdde | $ fdad fdd(f |
`, `X:10
T:2 Bars - The Maid Behind the Bar
L:1/8
Q:1/2=120
M:2/2
I:linebreak $
K:D
V:1 treble 
V:1
ef)ga bee(f | (3gfe) be gee(a |
`, `X:11
T:2 Bars - The Maid Behind the Bar
L:1/8
Q:1/2=120
M:2/2
I:linebreak $
K:D
V:1 treble 
V:1
fg)a(f b2) af | def(d e2) de |
`, `X:12
T:2 Bars - The Maid Behind the Bar
L:1/8
Q:1/2=120
M:2/2
I:linebreak $
K:D
V:1 treble 
V:1
f(B{/d}BA) Bcd(B | $ AF)EF D3 e |
`, `X:13
T:2 Bars - The Maid Behind the Bar
L:1/8
Q:1/2=120
M:2/2
I:linebreak $
K:D
V:1 treble 
V:1
fgag fdde | fdad fdd(f |
`, `X:14
T:2 Bars - The Maid Behind the Bar
L:1/8
Q:1/2=120
M:2/2
I:linebreak $
K:D
V:1 treble 
V:1
ef)ga bee(f | (3gfe) be gee(a |
`, `X:15
T:2 Bars - The Maid Behind the Bar
L:1/8
Q:1/2=120
M:2/2
I:linebreak $
K:D
V:1 treble 
V:1
fg)a(f b2) af | $ def(d e2) de |
`, `X:16
T:2 Bars - The Maid Behind the Bar
L:1/8
Q:1/2=120
M:2/2
I:linebreak $
K:D
V:1 treble 
V:1
f(B{/d}BA) BcdB | AFEF D3 |]
`, `X:1
T:4 Bars - The Maid Behind the Bar
L:1/8
Q:1/2=120
M:2/2
I:linebreak $
K:D
V:1 treble 
V:1
(DE) | FAA{/d}(B AF)ED | FAA{/d}(B A2) de | f(B{/d}BA) Bcd(e | f2) gf e(dBA) |
`, `X:2
T:4 Bars - The Maid Behind the Bar
L:1/8
Q:1/2=120
M:2/2
I:linebreak $
K:D
V:1 treble 
V:1
FAA{/d}(B AF)ED | FAA{/d}(B A2) de | f(B{/d}BA) Bcd(B | AF)EF D2 (DE) |
`, `X:3
T:4 Bars - The Maid Behind the Bar
L:1/8
Q:1/2=120
M:2/2
I:linebreak $
K:D
V:1 treble 
V:1
FAA{/d}(B AF)ED | FAA{/d}(B A2) de | f(B{/d}BA) Bcd(e | $ f2) gf e(dBA) |
`, `X:4
T:4 Bars - The Maid Behind the Bar
L:1/8
Q:1/2=120
M:2/2
I:linebreak $
K:D
V:1 treble 
V:1
FAA{/d}(B AF)ED | FAA{/d}(B A2) de | f(B{/d}BA) BcdB | AFEF D3 e ||
`, `X:5
T:4 Bars - The Maid Behind the Bar
L:1/8
Q:1/2=120
M:2/2
I:linebreak $
K:D
V:1 treble 
V:1
fgag fdde | $ fdad fdd(f | ef)ga bee(f | (3gfe) be gee(a |
`, `X:6
T:4 Bars - The Maid Behind the Bar
L:1/8
Q:1/2=120
M:2/2
I:linebreak $
K:D
V:1 treble 
V:1
fg)a(f b2) af | def(d e2) de | f(B{/d}BA) Bcd(B | $ AF)EF D3 e |
`, `X:7
T:4 Bars - The Maid Behind the Bar
L:1/8
Q:1/2=120
M:2/2
I:linebreak $
K:D
V:1 treble 
V:1
fgag fdde | fdad fdd(f | ef)ga bee(f | (3gfe) be gee(a |
`, `X:8
T:4 Bars - The Maid Behind the Bar
L:1/8
Q:1/2=120
M:2/2
I:linebreak $
K:D
V:1 treble 
V:1
fg)a(f b2) af | $ def(d e2) de | f(B{/d}BA) BcdB | AFEF D3 |]
`, `X:1
T:8 Bars - The Maid Behind the Bar
L:1/8
Q:1/2=120
M:2/2
I:linebreak $
K:D
V:1 treble 
V:1
(DE) | FAA{/d}(B AF)ED | FAA{/d}(B A2) de | f(B{/d}BA) Bcd(e | f2) gf e(dBA) | FAA{/d}(B AF)ED | FAA{/d}(B A2) de | f(B{/d}BA) Bcd(B | AF)EF D2 (DE) |
`, `X:2
T:8 Bars - The Maid Behind the Bar
L:1/8
Q:1/2=120
M:2/2
I:linebreak $
K:D
V:1 treble 
V:1
FAA{/d}(B AF)ED | FAA{/d}(B A2) de | f(B{/d}BA) Bcd(e | $ f2) gf e(dBA) | FAA{/d}(B AF)ED | FAA{/d}(B A2) de | f(B{/d}BA) BcdB | AFEF D3 e ||
`, `X:3
T:8 Bars - The Maid Behind the Bar
L:1/8
Q:1/2=120
M:2/2
I:linebreak $
K:D
V:1 treble 
V:1
fgag fdde | $ fdad fdd(f | ef)ga bee(f | (3gfe) be gee(a | fg)a(f b2) af | def(d e2) de | f(B{/d}BA) Bcd(B | $ AF)EF D3 e |
`, `X:4
T:8 Bars - The Maid Behind the Bar
L:1/8
Q:1/2=120
M:2/2
I:linebreak $
K:D
V:1 treble 
V:1
fgag fdde | fdad fdd(f | ef)ga bee(f | (3gfe) be gee(a | fg)a(f b2) af | $ def(d e2) de | f(B{/d}BA) BcdB | AFEF D3 |]
`
        ];


        var currentTune = 0;

        var synthControl;

        var abcOptions = {
            add_classes: true,
            responsive: "resize"
        };

        function load() {
            document.querySelector(".previous").addEventListener("click", previous);
            document.querySelector(".next").addEventListener("click", next);
            document.querySelector("#loop_checkbox").addEventListener("click", loop);
            document.querySelector(".start").addEventListener("click", start);
            document.querySelector(".restart").addEventListener("click", restart);
            document.querySelector(".warp50").addEventListener("click", () => warp(50));
            document.querySelector(".warp75").addEventListener("click", () => warp(75));
            document.querySelector(".warp100").addEventListener("click", () => warp(100));

            if (ABCJS.synth.supportsAudio()) {
                synthControl = new ABCJS.synth.SynthController();
                synthControl.load("#audio", false, { displayLoop: true, displayRestart: true, displayPlay: true, displayProgress: true, displayWarp: true });
            } else {
                console.log("Audio is not supported in this browser")
            }
            setTune(false);
        }

        function loop() {
            if (synthControl) {
                synthControl.toggleLoop();
            }
        }

        function start() {
            if (synthControl) {
                synthControl.play();
            }

        }

        function restart() {
            if (synthControl) {
                synthControl.restart();
            }
        }

        function warp(amount) {
            if (synthControl) {
                console.log("warp", amount)
                synthControl.setWarp(amount)
            }
        }

        function setTune(userAction) {
            synthControl.disable(true);
            var visualObj = ABCJS.renderAbc("paper", abc[currentTune], abcOptions)[0];

            if (synthControl) {
                synthControl.setTune(visualObj, userAction).then(function (response) {
                    console.log("Audio successfully loaded.")
                }).catch(function (error) {
                    console.warn("Audio problem:", error);
                });
            }
        };

        function previous() {
            currentTune--;
            if (currentTune < 0)
                currentTune = abc.length - 1;
            setTune(true);
        }

        function next() {
            currentTune++;
            if (currentTune >= abc.length)
                currentTune = 0;
            setTune(true);
        }
    </script>
</head>

<body onload="load()">
    <header>
    </header>
    <div class="container">
        <main>
            <button class="previous">Previous Tune</button>
            <button class="next">Next Tune</button>
            <input class="loop" id="loop_checkbox" type="checkbox" value="False">Loop</input>
            <button class="start">Start/Pause</button>
            <button class="restart">Restart</button>
            <button class="warp50">50%</button>
            <button class="warp75">75%</button>
            <button class="warp100">100%</button>
            <div id="paper"></div>
            <div id="audio"></div>
        </main>
    </div>
</body>

</html>